<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>京东物流 V1.0 报告（自动更新）</title>

  <!-- Markdown 渲染器（CDN，无需本地安装） -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <style>
    body { font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;
           margin: 0; padding: 0; background: #fafafa; color: #111; }
    header { padding: 16px 18px; background: #111; color: #fff; }
    header .sub { opacity: .8; font-size: 12px; margin-top: 6px; }
    main { max-width: 980px; margin: 18px auto; padding: 0 14px 30px; }
    .card { background: #fff; border-radius: 10px; box-shadow: 0 6px 20px rgba(0,0,0,.06); padding: 16px; }
    .meta { font-size: 12px; color: #666; margin: 10px 0 0; }
    .actions { margin-top: 10px; display: flex; gap: 10px; flex-wrap: wrap; }
    a.btn { display:inline-block; padding: 8px 12px; border-radius: 8px; text-decoration:none; border:1px solid #ddd; color:#111; background:#fff; }
    a.btn:hover { background:#f5f5f5; }
    #content { overflow-x: auto; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #e6e6e6; padding: 8px 10px; }
    th { background: #f7f7f7; }
    code { background:#f4f4f4; padding:2px 4px; border-radius:4px; }
    pre { background:#f4f4f4; padding:12px; border-radius:10px; overflow:auto; }
    .error { color: #b00020; }
  </style>
</head>

<body>
  <main>
    <div class="card">
      <div id="status">正在加载最新报告…</div>
      <div class="meta" id="meta"></div>

      <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />

      <div id="content"></div>
    </div>
  </main>

  <script>
    // 你的 report_latest.md raw 地址（固定）
    const RAW_MD = "https://raw.githubusercontent.com/njedu2023-prog/jd-logistics-v1-learning/main/report_latest.md";

    // 加时间戳，避免缓存导致看到旧内容
    const bust = `?t=${Date.now()}`;
    async function loadReport() {
      const statusEl = document.getElementById("status");
      const metaEl = document.getElementById("meta");
      const contentEl = document.getElementById("content");

      try {
        statusEl.textContent = "拉取中…";
        const res = await fetch(RAW_MD + bust, { cache: "no-store" });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const md = await res.text();

        // 渲染 Markdown → HTML
        const html = marked.parse(md);
        contentEl.innerHTML = html;

        statusEl.textContent = "已显示最新报告 ✅";
        metaEl.textContent = `更新时间：${new Date().toLocaleString("zh-CN")}（页面打开时实时拉取）`;
      } catch (e) {
        statusEl.innerHTML = `<span class="error">加载失败：${e.message}</span>`;
        metaEl.textContent = "你可以点上面的 Raw 链接确认 report_latest.md 是否可访问。";
      }
    }

    loadReport();
  </script>
</body>
</html>

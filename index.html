<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>京东物流 V1.0 法定预测报告</title>
  <style>
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Microsoft YaHei",Arial;
      margin:18px;background:#f6f7f9;color:#111
    }
    .wrap{max-width:1480px;margin:0 auto}
    .card{background:#fff;border:1px solid #e6e8eb;border-radius:12px;padding:18px;margin:14px 0;box-shadow:0 1px 2px rgba(0,0,0,.04)}
    h1{font-size:22px;margin:0 0 10px 0}
    .meta{font-size:13px;color:#555;line-height:1.6}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .badge{background:#f1f3f5;border:1px solid #e6e8eb;border-radius:10px;padding:6px 10px;font-size:13px;color:#333}
    pre{white-space:pre-wrap;word-break:break-word;margin:12px 0 0 0;font-size:13px;line-height:1.55}
    .err{color:#b42318}
    .btn{cursor:pointer;border:1px solid #e6e8eb;background:#fff;border-radius:10px;padding:8px 12px;font-size:13px}
    .topbar{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="topbar">
        <h1>京东物流 V1.0 法定预测报告</h1>
        <div class="row">
          <button class="btn" onclick="loadReport()">刷新数据</button>
        </div>
      </div>
      <div id="meta" class="meta">正在加载 latest_report.json ...</div>
      <pre id="out"></pre>
    </div>
  </div>

<script>
async function loadReport(){
  const meta = document.getElementById('meta');
  const out  = document.getElementById('out');

  try{
    // 加时间戳避免浏览器缓存
    const url = 'latest_report.json?t=' + Date.now();
    const r = await fetch(url, { cache: 'no-store' });
    if(!r.ok) throw new Error('HTTP ' + r.status + ' ' + r.statusText);

    const data = await r.json();

    // 这里先做“原样展示”，确保数据永远最新且可用
    // 你要“页面排版=你那份法定报告100%一致”，下一步我再按你的模板把 data 映射成固定板块渲染。
    const now = new Date().toISOString();
    const symbol = data.symbol || data.code || data.ticker || '02618.HK';
    const date = data.date || data.trade_date || data.trading_date || '未知';

    meta.innerHTML = `
      <div class="row">
        <div class="badge">代码：${symbol}</div>
        <div class="badge">时间：${date}</div>
        <div class="badge">页面刷新：${now}</div>
      </div>
      <div style="margin-top:8px">数据源：/latest_report.json（打开即最新；已禁用缓存）</div>
    `;

    out.textContent = JSON.stringify(data, null, 2);
  }catch(e){
    meta.innerHTML = `<div class="err">加载失败：${e.message}</div><div class="meta">请确认根目录存在 latest_report.json，且 GitHub Pages 已发布。</div>`;
    out.textContent = '';
  }
}
loadReport();
</script>
</body>
</html>
